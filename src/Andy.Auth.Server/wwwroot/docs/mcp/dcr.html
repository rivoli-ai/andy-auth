<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Client Registration - Andy Auth Documentation</title>
    <meta name="description" content="Learn how to use RFC 7591 Dynamic Client Registration for automatic OAuth client onboarding with Andy Auth">
    <link rel="stylesheet" href="/docs/css/docs.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="docs-header">
        <div class="docs-header-inner">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <button class="docs-mobile-toggle" id="sidebar-toggle">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <a href="/docs/" class="docs-logo">
                    <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="32" height="32" rx="8" fill="currentColor"/>
                        <path d="M8 24V8h6l4 8 4-8h6v16h-5V14l-3.5 7h-3L13 14v10H8z" fill="white"/>
                    </svg>
                    <span class="docs-logo-text">
                        <span class="docs-logo-title">Andy Auth</span>
                        <span class="docs-logo-subtitle">Documentation</span>
                    </span>
                    <span class="docs-version">v1.0</span>
                </a>
            </div>
            <div class="docs-search">
                <div class="docs-search-wrapper">
                    <svg class="docs-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    <input type="text" class="docs-search-input" placeholder="Search documentation..." data-search-trigger readonly>
                    <span class="docs-search-shortcut">Ctrl K</span>
                </div>
            </div>
            <div class="docs-header-actions">
                <button class="docs-header-btn" id="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
                    </svg>
                </button>
                <a href="https://github.com/rivoli-ai/andy-auth" class="docs-header-btn" title="GitHub" target="_blank">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
                    </svg>
                </a>
                <a href="/" class="docs-header-link">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
                    </svg>
                    <span>Back to App</span>
                </a>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <aside class="docs-sidebar">
        <nav>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">Getting Started</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/" class="docs-sidebar-link">Overview</a></li>
                    <li><a href="/docs/quickstart.html" class="docs-sidebar-link">Quick Start</a></li>
                    <li><a href="/docs/installation.html" class="docs-sidebar-link">Installation</a></li>
                    <li><a href="/docs/configuration.html" class="docs-sidebar-link">Configuration</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">MCP Integration <span class="badge badge-new">Important</span></div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/mcp/overview.html" class="docs-sidebar-link">MCP Overview</a></li>
                    <li><a href="/docs/mcp/oauth-flow.html" class="docs-sidebar-link">OAuth 2.1 Flow</a></li>
                    <li><a href="/docs/mcp/claude-desktop.html" class="docs-sidebar-link">Claude Desktop</a></li>
                    <li><a href="/docs/mcp/chatgpt.html" class="docs-sidebar-link">ChatGPT</a></li>
                    <li><a href="/docs/mcp/vscode-extensions.html" class="docs-sidebar-link">VS Code Extensions</a></li>
                    <li><a href="/docs/mcp/dcr.html" class="docs-sidebar-link active">Dynamic Client Registration</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">OAuth & OpenID Connect</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/oauth/concepts.html" class="docs-sidebar-link">Core Concepts</a></li>
                    <li><a href="/docs/oauth/authorization-code.html" class="docs-sidebar-link">Authorization Code Flow</a></li>
                    <li><a href="/docs/oauth/pkce.html" class="docs-sidebar-link">PKCE</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">Tutorials</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/tutorials/csharp.html" class="docs-sidebar-link">C# / .NET</a></li>
                    <li><a href="/docs/tutorials/python.html" class="docs-sidebar-link">Python</a></li>
                    <li><a href="/docs/tutorials/javascript.html" class="docs-sidebar-link">JavaScript</a></li>
                    <li><a href="/docs/tutorials/typescript.html" class="docs-sidebar-link">TypeScript</a></li>
                    <li><a href="/docs/tutorials/java.html" class="docs-sidebar-link">Java</a></li>
                    <li><a href="/docs/tutorials/go.html" class="docs-sidebar-link">Go</a></li>
                    <li><a href="/docs/tutorials/rust.html" class="docs-sidebar-link">Rust</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">API Reference</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/api/endpoints.html" class="docs-sidebar-link">Endpoints Overview</a></li>
                    <li><a href="/docs/api/authorize.html" class="docs-sidebar-link">Authorization</a></li>
                    <li><a href="/docs/api/token.html" class="docs-sidebar-link">Token</a></li>
                    <li><a href="/docs/api/register.html" class="docs-sidebar-link">Client Registration</a></li>
                </ul>
            </div>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="docs-main">
        <article class="docs-content">
            <nav class="docs-breadcrumb">
                <a href="/docs/">Docs</a>
                <span class="docs-breadcrumb-sep">/</span>
                <a href="/docs/mcp/overview.html">MCP Integration</a>
                <span class="docs-breadcrumb-sep">/</span>
                <span class="docs-breadcrumb-current">Dynamic Client Registration</span>
            </nav>

            <h1>Dynamic Client Registration</h1>
            <p class="lead">
                Dynamic Client Registration (DCR) allows MCP clients and tools to automatically register
                with Andy Auth without manual configuration, following RFC 7591.
            </p>

            <div class="callout callout-info">
                <div class="callout-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
                    RFC 7591 Compliance
                </div>
                <p>
                    Andy Auth implements RFC 7591 (OAuth 2.0 Dynamic Client Registration Protocol),
                    enabling automatic client onboarding for MCP tools, custom AI assistants, and
                    third-party integrations.
                </p>
            </div>

            <h2 id="overview">What is Dynamic Client Registration?</h2>

            <p>
                Dynamic Client Registration enables OAuth clients to register programmatically with Andy Auth,
                eliminating the need for manual client setup. This is particularly useful for:
            </p>

            <ul>
                <li><strong>MCP tool developers</strong> - Tools can self-register when users connect</li>
                <li><strong>Custom AI assistants</strong> - New assistants can onboard automatically</li>
                <li><strong>Enterprise deployments</strong> - Automated client provisioning at scale</li>
                <li><strong>Development workflows</strong> - Quick setup for testing and development</li>
            </ul>

            <h2 id="endpoint">Registration Endpoint</h2>

            <div class="endpoint">
                <span class="endpoint-method post">POST</span>
                <span class="endpoint-path">/connect/register</span>
            </div>

            <p>The endpoint is also discoverable via OpenID Connect Discovery at <code>/.well-known/openid-configuration</code>
            in the <code>registration_endpoint</code> field.</p>

            <h2 id="basic-registration">Basic Client Registration</h2>

            <p>Register a new OAuth client by sending a POST request with client metadata:</p>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">bash</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code>curl -X POST https://auth.example.com/connect/register \
  -H "Content-Type: application/json" \
  -d '{
    "client_name": "My MCP Tool",
    "redirect_uris": ["http://localhost:3000/callback"],
    "grant_types": ["authorization_code", "refresh_token"],
    "response_types": ["code"],
    "token_endpoint_auth_method": "none"
  }'</code></pre>
            </div>

            <h3 id="registration-response">Registration Response</h3>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">json</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code>{
  "client_id": "dcr_a1b2c3d4e5f6",
  "client_id_issued_at": 1704067200,
  "client_name": "My MCP Tool",
  "redirect_uris": ["http://localhost:3000/callback"],
  "grant_types": ["authorization_code", "refresh_token"],
  "response_types": ["code"],
  "token_endpoint_auth_method": "none",
  "registration_access_token": "rat_xyz789abc123",
  "registration_client_uri": "https://auth.example.com/connect/register/dcr_a1b2c3d4e5f6"
}</code></pre>
            </div>

            <h2 id="request-parameters">Request Parameters</h2>

            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Required</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>client_name</code></td>
                        <td>Yes</td>
                        <td>Human-readable name displayed on consent screen</td>
                    </tr>
                    <tr>
                        <td><code>redirect_uris</code></td>
                        <td>Yes</td>
                        <td>Array of allowed redirect URIs</td>
                    </tr>
                    <tr>
                        <td><code>grant_types</code></td>
                        <td>No</td>
                        <td>OAuth grant types (default: <code>["authorization_code"]</code>)</td>
                    </tr>
                    <tr>
                        <td><code>response_types</code></td>
                        <td>No</td>
                        <td>OAuth response types (default: <code>["code"]</code>)</td>
                    </tr>
                    <tr>
                        <td><code>token_endpoint_auth_method</code></td>
                        <td>No</td>
                        <td>Authentication method: <code>none</code>, <code>client_secret_post</code>, <code>client_secret_basic</code></td>
                    </tr>
                    <tr>
                        <td><code>scope</code></td>
                        <td>No</td>
                        <td>Space-separated list of allowed scopes</td>
                    </tr>
                    <tr>
                        <td><code>client_uri</code></td>
                        <td>No</td>
                        <td>URL of the client's home page</td>
                    </tr>
                    <tr>
                        <td><code>logo_uri</code></td>
                        <td>No</td>
                        <td>URL of the client's logo image</td>
                    </tr>
                    <tr>
                        <td><code>contacts</code></td>
                        <td>No</td>
                        <td>Array of contact email addresses</td>
                    </tr>
                    <tr>
                        <td><code>tos_uri</code></td>
                        <td>No</td>
                        <td>URL of Terms of Service</td>
                    </tr>
                    <tr>
                        <td><code>policy_uri</code></td>
                        <td>No</td>
                        <td>URL of Privacy Policy</td>
                    </tr>
                </tbody>
            </table>

            <h2 id="mcp-client-example">MCP Client Registration Example</h2>

            <p>Here's a complete example of registering an MCP tool programmatically:</p>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">javascript</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code>async function registerMcpClient(authServerUrl, clientInfo) {
    // Discover registration endpoint
    const discoveryUrl = `${authServerUrl}/.well-known/openid-configuration`;
    const config = await fetch(discoveryUrl).then(r => r.json());

    const registrationEndpoint = config.registration_endpoint;

    // Register the client
    const response = await fetch(registrationEndpoint, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            client_name: clientInfo.name,
            redirect_uris: clientInfo.redirectUris,
            grant_types: ['authorization_code', 'refresh_token'],
            response_types: ['code'],
            token_endpoint_auth_method: 'none',
            scope: 'openid profile email offline_access',
            client_uri: clientInfo.homepage,
            logo_uri: clientInfo.logoUrl,
            contacts: [clientInfo.contactEmail]
        })
    });

    if (!response.ok) {
        const error = await response.json();
        throw new Error(`Registration failed: ${error.error_description || error.error}`);
    }

    const clientData = await response.json();

    // Store client credentials securely
    return {
        clientId: clientData.client_id,
        registrationAccessToken: clientData.registration_access_token,
        registrationUri: clientData.registration_client_uri
    };
}

// Usage
const client = await registerMcpClient('https://auth.example.com', {
    name: 'Code Analysis MCP Tool',
    redirectUris: ['http://localhost:8080/oauth/callback'],
    homepage: 'https://my-mcp-tool.example.com',
    logoUrl: 'https://my-mcp-tool.example.com/logo.png',
    contactEmail: 'support@my-mcp-tool.example.com'
});

console.log('Client ID:', client.clientId);</code></pre>
            </div>

            <h2 id="confidential-client">Registering Confidential Clients</h2>

            <p>For server-side applications that can securely store secrets:</p>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">json</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code>// Request
{
  "client_name": "Backend MCP Service",
  "redirect_uris": ["https://api.example.com/oauth/callback"],
  "grant_types": ["authorization_code", "refresh_token", "client_credentials"],
  "response_types": ["code"],
  "token_endpoint_auth_method": "client_secret_basic",
  "scope": "openid profile api:read api:write"
}

// Response includes client_secret
{
  "client_id": "dcr_backend_service_123",
  "client_secret": "cs_super_secret_value_xyz",
  "client_secret_expires_at": 0,
  "client_name": "Backend MCP Service",
  "redirect_uris": ["https://api.example.com/oauth/callback"],
  "grant_types": ["authorization_code", "refresh_token", "client_credentials"],
  "token_endpoint_auth_method": "client_secret_basic",
  "registration_access_token": "rat_...",
  "registration_client_uri": "https://auth.example.com/connect/register/dcr_backend_service_123"
}</code></pre>
            </div>

            <div class="callout callout-warning">
                <div class="callout-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    Security Warning
                </div>
                <p>
                    The <code>client_secret</code> is only returned once during registration. Store it securely immediately.
                    If lost, you must register a new client.
                </p>
            </div>

            <h2 id="client-management">Managing Registered Clients</h2>

            <h3 id="read-client">Reading Client Configuration</h3>

            <p>Use the registration access token to read current client configuration:</p>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">bash</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code>curl https://auth.example.com/connect/register/dcr_a1b2c3d4e5f6 \
  -H "Authorization: Bearer rat_xyz789abc123"</code></pre>
            </div>

            <h3 id="update-client">Updating Client Configuration</h3>

            <p>Update client metadata using PUT request:</p>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">bash</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code>curl -X PUT https://auth.example.com/connect/register/dcr_a1b2c3d4e5f6 \
  -H "Authorization: Bearer rat_xyz789abc123" \
  -H "Content-Type: application/json" \
  -d '{
    "client_id": "dcr_a1b2c3d4e5f6",
    "client_name": "My MCP Tool (Updated)",
    "redirect_uris": [
      "http://localhost:3000/callback",
      "http://localhost:3001/callback"
    ],
    "grant_types": ["authorization_code", "refresh_token"],
    "response_types": ["code"],
    "token_endpoint_auth_method": "none"
  }'</code></pre>
            </div>

            <h3 id="delete-client">Deleting a Client</h3>

            <p>Remove a registered client:</p>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">bash</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code>curl -X DELETE https://auth.example.com/connect/register/dcr_a1b2c3d4e5f6 \
  -H "Authorization: Bearer rat_xyz789abc123"</code></pre>
            </div>

            <h2 id="python-example">Python DCR Example</h2>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">python</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code>import requests
import json

class OAuthDynamicClient:
    def __init__(self, auth_server_url):
        self.auth_server_url = auth_server_url
        self.client_id = None
        self.registration_access_token = None
        self.registration_uri = None

    def discover(self):
        """Discover OAuth endpoints from the authorization server."""
        discovery_url = f"{self.auth_server_url}/.well-known/openid-configuration"
        response = requests.get(discovery_url)
        response.raise_for_status()
        return response.json()

    def register(self, client_name, redirect_uris, **kwargs):
        """Register a new OAuth client dynamically."""
        config = self.discover()
        registration_endpoint = config.get('registration_endpoint')

        if not registration_endpoint:
            raise ValueError("Server does not support dynamic client registration")

        client_metadata = {
            'client_name': client_name,
            'redirect_uris': redirect_uris,
            'grant_types': kwargs.get('grant_types', ['authorization_code', 'refresh_token']),
            'response_types': kwargs.get('response_types', ['code']),
            'token_endpoint_auth_method': kwargs.get('auth_method', 'none'),
            'scope': kwargs.get('scope', 'openid profile email'),
        }

        # Add optional metadata
        for key in ['client_uri', 'logo_uri', 'contacts', 'tos_uri', 'policy_uri']:
            if key in kwargs:
                client_metadata[key] = kwargs[key]

        response = requests.post(
            registration_endpoint,
            json=client_metadata,
            headers={'Content-Type': 'application/json'}
        )
        response.raise_for_status()

        data = response.json()

        self.client_id = data['client_id']
        self.registration_access_token = data.get('registration_access_token')
        self.registration_uri = data.get('registration_client_uri')

        return data

    def read_configuration(self):
        """Read current client configuration."""
        if not self.registration_uri or not self.registration_access_token:
            raise ValueError("Client not registered or missing registration credentials")

        response = requests.get(
            self.registration_uri,
            headers={'Authorization': f'Bearer {self.registration_access_token}'}
        )
        response.raise_for_status()
        return response.json()

    def update(self, **updates):
        """Update client configuration."""
        current = self.read_configuration()
        current.update(updates)

        response = requests.put(
            self.registration_uri,
            json=current,
            headers={
                'Authorization': f'Bearer {self.registration_access_token}',
                'Content-Type': 'application/json'
            }
        )
        response.raise_for_status()
        return response.json()

    def delete(self):
        """Delete the registered client."""
        response = requests.delete(
            self.registration_uri,
            headers={'Authorization': f'Bearer {self.registration_access_token}'}
        )
        response.raise_for_status()


# Usage example
if __name__ == "__main__":
    client = OAuthDynamicClient("https://auth.example.com")

    # Register a new MCP tool
    registration = client.register(
        client_name="My Python MCP Tool",
        redirect_uris=["http://localhost:8000/callback"],
        scope="openid profile email offline_access",
        contacts=["developer@example.com"]
    )

    print(f"Registered client ID: {registration['client_id']}")

    # Read configuration
    config = client.read_configuration()
    print(f"Current redirect URIs: {config['redirect_uris']}")

    # Update configuration
    updated = client.update(
        redirect_uris=[
            "http://localhost:8000/callback",
            "http://localhost:8001/callback"
        ]
    )
    print(f"Updated redirect URIs: {updated['redirect_uris']}")</code></pre>
            </div>

            <h2 id="error-handling">Error Handling</h2>

            <p>DCR endpoints return standard OAuth 2.0 error responses:</p>

            <table>
                <thead>
                    <tr>
                        <th>Error Code</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>invalid_redirect_uri</code></td>
                        <td>One or more redirect URIs are invalid</td>
                    </tr>
                    <tr>
                        <td><code>invalid_client_metadata</code></td>
                        <td>Client metadata is malformed or contains invalid values</td>
                    </tr>
                    <tr>
                        <td><code>invalid_software_statement</code></td>
                        <td>Software statement JWT is invalid (if provided)</td>
                    </tr>
                    <tr>
                        <td><code>unapproved_software_statement</code></td>
                        <td>Software statement is not approved</td>
                    </tr>
                </tbody>
            </table>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">json</span>
                </div>
                <pre><code>// Error response example
{
  "error": "invalid_redirect_uri",
  "error_description": "The redirect_uri 'http://example.com' is not allowed. Only localhost and HTTPS URIs are permitted."
}</code></pre>
            </div>

            <h2 id="security-considerations">Security Considerations</h2>

            <ul>
                <li><strong>Registration Access Token</strong>: Store securely - it grants full control over the client registration</li>
                <li><strong>HTTPS Required</strong>: DCR requests should only be made over HTTPS in production</li>
                <li><strong>Redirect URI Validation</strong>: Andy Auth validates redirect URIs - only localhost (for development) and HTTPS URIs are typically allowed</li>
                <li><strong>Rate Limiting</strong>: DCR endpoints may be rate-limited to prevent abuse</li>
                <li><strong>Scope Restrictions</strong>: Dynamically registered clients may have restricted scope access compared to pre-configured clients</li>
            </ul>

            <div class="callout callout-info">
                <div class="callout-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
                    Pre-configured vs Dynamic Clients
                </div>
                <p>
                    Pre-configured clients (like <code>claude-desktop</code>, <code>chatgpt</code>) have pre-approved
                    redirect URIs and scopes. Dynamically registered clients may have additional restrictions
                    depending on Andy Auth's DCR policy configuration.
                </p>
            </div>

            <h2 id="troubleshooting">Troubleshooting</h2>

            <h3 id="issue-registration-disabled">Registration Endpoint Returns 404</h3>

            <div class="callout callout-warning">
                <div class="callout-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    Solution
                </div>
                <p>
                    DCR may be disabled on the server. Check the OpenID Discovery document for
                    <code>registration_endpoint</code>. If missing, contact the server administrator.
                </p>
            </div>

            <h3 id="issue-invalid-redirect">Invalid Redirect URI Error</h3>

            <div class="callout callout-warning">
                <div class="callout-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    Solution
                </div>
                <ul>
                    <li>Use <code>http://localhost:*</code> for local development</li>
                    <li>Use HTTPS for production redirect URIs</li>
                    <li>Avoid wildcards in redirect URIs</li>
                    <li>Ensure URIs don't contain fragments (#)</li>
                </ul>
            </div>

            <h3 id="issue-access-token-expired">Registration Access Token Expired</h3>

            <div class="callout callout-warning">
                <div class="callout-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    Solution
                </div>
                <p>
                    If the registration access token expires, you must register a new client.
                    Store the token securely and consider implementing token rotation.
                </p>
            </div>

            <h2 id="next-steps">Next Steps</h2>

            <div class="docs-cards">
                <a href="/docs/mcp/oauth-flow.html" class="docs-card">
                    <div class="docs-card-title">OAuth 2.1 Flow</div>
                    <div class="docs-card-desc">Use your registered client with the OAuth 2.1 flow.</div>
                </a>
                <a href="/docs/api/register.html" class="docs-card">
                    <div class="docs-card-title">API Reference</div>
                    <div class="docs-card-desc">Complete API documentation for client registration.</div>
                </a>
                <a href="/docs/mcp/overview.html" class="docs-card">
                    <div class="docs-card-title">MCP Overview</div>
                    <div class="docs-card-desc">Learn about MCP integration with Andy Auth.</div>
                </a>
            </div>

            <nav class="docs-page-nav">
                <a href="/docs/mcp/vscode-extensions.html" class="docs-page-nav-link prev">
                    <span class="docs-page-nav-label">Previous</span>
                    <span class="docs-page-nav-title">VS Code Extensions</span>
                </a>
                <a href="/docs/oauth/concepts.html" class="docs-page-nav-link next">
                    <span class="docs-page-nav-label">Next</span>
                    <span class="docs-page-nav-title">OAuth Core Concepts</span>
                </a>
            </nav>
        </article>

        <aside class="docs-toc">
            <div class="docs-toc-title">On this page</div>
            <ul class="docs-toc-list"></ul>
        </aside>
    </main>

    <div class="docs-search-modal" id="search-modal">
        <div class="docs-search-modal-content">
            <input type="text" class="docs-search-modal-input" id="search-modal-input" placeholder="Search documentation...">
            <div class="docs-search-results" id="search-results"></div>
        </div>
    </div>

    <script src="/docs/js/docs.js"></script>
</body>
</html>
