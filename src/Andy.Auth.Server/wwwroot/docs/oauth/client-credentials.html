<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Credentials Grant - Andy Auth Documentation</title>
    <meta name="description" content="Client Credentials Flow for server-to-server auth">
    <link rel="stylesheet" href="/docs/css/docs.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="/docs/images/favicon.png">
</head>
<body>
    <!-- Header -->
        <header class="docs-header">
        <div class="docs-header-inner">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <button class="docs-mobile-toggle" id="sidebar-toggle">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <a href="/docs/" class="docs-logo">
                    <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="32" height="32" rx="8" fill="currentColor"/>
                        <path d="M8 24V8h6l4 8 4-8h6v16h-5V14l-3.5 7h-3L13 14v10H8z" fill="white"/>
                    </svg>
                    <span class="docs-logo-text">
                        <span class="docs-logo-title">Andy Auth</span>
                        <span class="docs-logo-subtitle">Documentation</span>
                    </span>
                    <span class="docs-version">v1.0</span>
                </a>
            </div>

            <div class="docs-search">
                <div class="docs-search-wrapper">
                    <svg class="docs-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    <input type="text" class="docs-search-input" placeholder="Search documentation..." data-search-trigger readonly>
                    <span class="docs-search-shortcut">Ctrl K</span>
                </div>
            </div>

            <div class="docs-header-actions">
                <button class="docs-header-btn" id="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
                    </svg>
                </button>
                <a href="https://github.com/rivoli-ai/andy-auth" class="docs-header-btn" title="GitHub" target="_blank">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
                    </svg>
                </a>
                <a href="/" class="docs-header-link">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
                    </svg>
                    <span>Back to App</span>
                </a>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
        <aside class="docs-sidebar">
        <nav>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">Getting Started</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/" class="docs-sidebar-link">Overview</a></li>
                    <li><a href="/docs/quickstart.html" class="docs-sidebar-link">Quick Start</a></li>
                    <li><a href="/docs/installation.html" class="docs-sidebar-link">Installation</a></li>
                    <li><a href="/docs/configuration.html" class="docs-sidebar-link">Configuration</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">MCP Integration <span class="badge badge-new">Important</span></div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/mcp/overview.html" class="docs-sidebar-link">MCP Overview</a></li>
                    <li><a href="/docs/mcp/oauth-flow.html" class="docs-sidebar-link">OAuth 2.1 Flow</a></li>
                    <li><a href="/docs/mcp/claude-desktop.html" class="docs-sidebar-link">Claude Desktop</a></li>
                    <li><a href="/docs/mcp/chatgpt.html" class="docs-sidebar-link">ChatGPT</a></li>
                    <li><a href="/docs/mcp/vscode-extensions.html" class="docs-sidebar-link">VS Code Extensions</a></li>
                    <li><a href="/docs/mcp/dcr.html" class="docs-sidebar-link">Dynamic Client Registration</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">OAuth & OpenID Connect</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/oauth/concepts.html" class="docs-sidebar-link">Core Concepts</a></li>
                    <li><a href="/docs/oauth/authorization-code.html" class="docs-sidebar-link">Authorization Code Flow</a></li>
                    <li><a href="/docs/oauth/pkce.html" class="docs-sidebar-link">PKCE</a></li>
                    <li><a href="/docs/oauth/client-credentials.html" class="docs-sidebar-link active">Client Credentials</a></li>
                    <li><a href="/docs/oauth/access-tokens.html" class="docs-sidebar-link">Access Tokens</a></li>
                    <li><a href="/docs/oauth/refresh-tokens.html" class="docs-sidebar-link">Refresh Tokens</a></li>
                    <li><a href="/docs/oauth/scopes.html" class="docs-sidebar-link">Scopes</a></li>
                    <li><a href="/docs/oauth/claims.html" class="docs-sidebar-link">Claims</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">Tutorials</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/tutorials/python.html" class="docs-sidebar-link">Python</a></li>
                    <li><a href="/docs/tutorials/csharp.html" class="docs-sidebar-link">C# / .NET</a></li>
                    <li><a href="/docs/tutorials/javascript.html" class="docs-sidebar-link">JavaScript</a></li>
                    <li><a href="/docs/tutorials/typescript.html" class="docs-sidebar-link">TypeScript</a></li>
                    <li><a href="/docs/tutorials/java.html" class="docs-sidebar-link">Java</a></li>
                    <li><a href="/docs/tutorials/go.html" class="docs-sidebar-link">Go</a></li>
                    <li><a href="/docs/tutorials/rust.html" class="docs-sidebar-link">Rust</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">API Reference</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/api/endpoints.html" class="docs-sidebar-link">Endpoints Overview</a></li>
                    <li><a href="/docs/api/authorize.html" class="docs-sidebar-link">Authorization</a></li>
                    <li><a href="/docs/api/token.html" class="docs-sidebar-link">Token</a></li>
                    <li><a href="/docs/api/userinfo.html" class="docs-sidebar-link">UserInfo</a></li>
                    <li><a href="/docs/api/introspect.html" class="docs-sidebar-link">Introspection</a></li>
                    <li><a href="/docs/api/revoke.html" class="docs-sidebar-link">Revocation</a></li>
                    <li><a href="/docs/api/register.html" class="docs-sidebar-link">Client Registration</a></li>
                    <li><a href="/docs/api/discovery.html" class="docs-sidebar-link">Discovery</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">Admin Dashboard <span class="badge badge-new">New</span></div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/admin/dashboard.html" class="docs-sidebar-link">Dashboard</a></li>
                    <li><a href="/docs/admin/users.html" class="docs-sidebar-link">Users</a></li>
                    <li><a href="/docs/admin/clients.html" class="docs-sidebar-link">Clients</a></li>
                    <li><a href="/docs/admin/tokens.html" class="docs-sidebar-link">Tokens</a></li>
                    <li><a href="/docs/admin/audit-logs.html" class="docs-sidebar-link">Audit Logs</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">Deployment</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/deployment/railway.html" class="docs-sidebar-link">Railway</a></li>
                    <li><a href="/docs/deployment/docker.html" class="docs-sidebar-link">Docker</a></li>
                    <li><a href="/docs/deployment/production.html" class="docs-sidebar-link">Production</a></li>
                    <li><a href="/docs/deployment/azure.html" class="docs-sidebar-link">Azure</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">Security</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/security/overview.html" class="docs-sidebar-link">Security Overview</a></li>
                </ul>
            </div>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="docs-main">
        <article class="docs-content">
            <nav class="docs-breadcrumb">
                <a href="/docs/">Docs</a>
                <span class="docs-breadcrumb-sep">/</span>
                <a href="/docs/oauth/concepts.html">OAuth & OpenID Connect</a>
                <span class="docs-breadcrumb-sep">/</span>
                <span class="docs-breadcrumb-current">Client Credentials</span>
            </nav>

            <h1>Client Credentials Grant</h1>
            <p class="lead">
                The Client Credentials grant is designed for server-to-server authentication where no user interaction
                is required. It allows a confidential client to obtain an access token using only its own credentials.
            </p>

            <div class="callout callout-info">
                <div class="callout-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
                    When to Use Client Credentials
                </div>
                <p>
                    Use the Client Credentials grant when your application needs to access its own resources or
                    perform operations that don't require user authorization. Common use cases include background
                    services, scheduled jobs, microservice communication, and API-to-API integrations.
                </p>
            </div>

            <h2 id="how-it-works">How It Works</h2>

            <p>
                The Client Credentials flow is the simplest OAuth 2.0 grant type. The client authenticates directly
                with the authorization server using its credentials (client ID and client secret) and receives an
                access token in response.
            </p>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">text</span>
                </div>
                <pre><code class="language-none">┌──────────────┐                                  ┌──────────────┐
│              │                                  │              │
│    Client    │                                  │  Andy Auth   │
│  (Backend)   │                                  │   (OAuth)    │
│              │                                  │              │
└──────┬───────┘                                  └──────┬───────┘
       │                                                 │
       │  1. Token Request                               │
       │  POST /connect/token                            │
       │  grant_type=client_credentials                  │
       │  client_id=xxx&client_secret=yyy                │
       │────────────────────────────────────────────────>│
       │                                                 │
       │  2. Access Token Response                       │
       │  {                                              │
       │    "access_token": "eyJhbG...",                 │
       │    "token_type": "Bearer",                      │
       │    "expires_in": 3600                           │
       │  }                                              │
       │<────────────────────────────────────────────────│
       │                                                 │</code></pre>
            </div>

            <h2 id="prerequisites">Prerequisites</h2>

            <p>Before using the Client Credentials grant, ensure you have:</p>

            <ul>
                <li><strong>A confidential client</strong> - Registered with Andy Auth as a confidential (not public) client</li>
                <li><strong>Client credentials</strong> - A client ID and client secret</li>
                <li><strong>Authorized scopes</strong> - The client must be configured with the scopes it needs to request</li>
            </ul>

            <div class="callout callout-warning">
                <div class="callout-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    Security Consideration
                </div>
                <p>
                    The Client Credentials grant requires storing client secrets securely. Never expose client secrets
                    in client-side code, mobile apps, or version control. Use environment variables or secret
                    management systems.
                </p>
            </div>

            <h2 id="token-request">Token Request</h2>

            <p>To obtain an access token, make a POST request to the token endpoint:</p>

            <div class="endpoint">
                <span class="endpoint-method post">POST</span>
                <span class="endpoint-path">/connect/token</span>
            </div>

            <h3>Request Parameters</h3>

            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Required</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>grant_type</code></td>
                        <td>Yes</td>
                        <td>Must be <code>client_credentials</code></td>
                    </tr>
                    <tr>
                        <td><code>client_id</code></td>
                        <td>Yes</td>
                        <td>Your application's client identifier</td>
                    </tr>
                    <tr>
                        <td><code>client_secret</code></td>
                        <td>Yes</td>
                        <td>Your application's client secret</td>
                    </tr>
                    <tr>
                        <td><code>scope</code></td>
                        <td>No</td>
                        <td>Space-separated list of scopes. Defaults to the client's configured scopes.</td>
                    </tr>
                </tbody>
            </table>

            <h3>Example Request</h3>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">bash</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-bash">curl -X POST https://auth.example.com/connect/token \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "grant_type=client_credentials" \
  -d "client_id=my-backend-service" \
  -d "client_secret=super-secret-key" \
  -d "scope=api.read api.write"</code></pre>
            </div>

            <h3>Using Basic Authentication</h3>

            <p>
                Alternatively, you can provide client credentials using HTTP Basic authentication instead of
                including them in the request body:
            </p>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">bash</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-bash"># Base64 encode: my-backend-service:super-secret-key
curl -X POST https://auth.example.com/connect/token \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic bXktYmFja2VuZC1zZXJ2aWNlOnN1cGVyLXNlY3JldC1rZXk=" \
  -d "grant_type=client_credentials" \
  -d "scope=api.read api.write"</code></pre>
            </div>

            <h2 id="token-response">Token Response</h2>

            <p>A successful response includes the access token:</p>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">json</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-json">{
  "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJodHRwczovL2F1dGguZXhhbXBsZS5jb20iLCJzdWIiOiJteS1iYWNrZW5kLXNlcnZpY2UiLCJhdWQiOiJhcGkuZXhhbXBsZS5jb20iLCJleHAiOjE3MDAwMDAwMDAsImlhdCI6MTY5OTk5NjQwMCwic2NvcGUiOiJhcGkucmVhZCBhcGkud3JpdGUifQ.signature",
  "token_type": "Bearer",
  "expires_in": 3600,
  "scope": "api.read api.write"
}</code></pre>
            </div>

            <h3>Response Fields</h3>

            <table>
                <thead>
                    <tr>
                        <th>Field</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>access_token</code></td>
                        <td>The JWT access token to use for API requests</td>
                    </tr>
                    <tr>
                        <td><code>token_type</code></td>
                        <td>Always <code>Bearer</code></td>
                    </tr>
                    <tr>
                        <td><code>expires_in</code></td>
                        <td>Token lifetime in seconds (typically 3600 = 1 hour)</td>
                    </tr>
                    <tr>
                        <td><code>scope</code></td>
                        <td>The scopes granted to the token</td>
                    </tr>
                </tbody>
            </table>

            <div class="callout callout-info">
                <div class="callout-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
                    No Refresh Token
                </div>
                <p>
                    The Client Credentials grant does not issue refresh tokens. When your access token expires,
                    simply request a new one using the same client credentials. Since this is a server-to-server
                    flow, obtaining new tokens is straightforward.
                </p>
            </div>

            <h2 id="code-examples">Code Examples</h2>

            <h3>C# / .NET</h3>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">csharp</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-csharp">using System.Net.Http;
using System.Text.Json;

public class TokenService
{
    private readonly HttpClient _httpClient;
    private readonly string _tokenEndpoint = "https://auth.example.com/connect/token";
    private readonly string _clientId;
    private readonly string _clientSecret;

    public TokenService(string clientId, string clientSecret)
    {
        _httpClient = new HttpClient();
        _clientId = clientId;
        _clientSecret = clientSecret;
    }

    public async Task&lt;string&gt; GetAccessTokenAsync(string[] scopes)
    {
        var request = new FormUrlEncodedContent(new Dictionary&lt;string, string&gt;
        {
            ["grant_type"] = "client_credentials",
            ["client_id"] = _clientId,
            ["client_secret"] = _clientSecret,
            ["scope"] = string.Join(" ", scopes)
        });

        var response = await _httpClient.PostAsync(_tokenEndpoint, request);
        response.EnsureSuccessStatusCode();

        var json = await response.Content.ReadAsStringAsync();
        var tokenResponse = JsonSerializer.Deserialize&lt;TokenResponse&gt;(json);

        return tokenResponse.AccessToken;
    }
}

public class TokenResponse
{
    [JsonPropertyName("access_token")]
    public string AccessToken { get; set; }

    [JsonPropertyName("token_type")]
    public string TokenType { get; set; }

    [JsonPropertyName("expires_in")]
    public int ExpiresIn { get; set; }
}</code></pre>
            </div>

            <h3>Python</h3>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">python</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-python">import requests
from datetime import datetime, timedelta

class TokenManager:
    def __init__(self, client_id: str, client_secret: str, token_endpoint: str):
        self.client_id = client_id
        self.client_secret = client_secret
        self.token_endpoint = token_endpoint
        self._access_token = None
        self._expires_at = None

    def get_access_token(self, scopes: list[str] = None) -> str:
        """Get a valid access token, refreshing if necessary."""
        if self._is_token_valid():
            return self._access_token

        response = requests.post(
            self.token_endpoint,
            data={
                'grant_type': 'client_credentials',
                'client_id': self.client_id,
                'client_secret': self.client_secret,
                'scope': ' '.join(scopes) if scopes else ''
            }
        )
        response.raise_for_status()

        token_data = response.json()
        self._access_token = token_data['access_token']
        self._expires_at = datetime.now() + timedelta(
            seconds=token_data['expires_in'] - 60  # Buffer of 60 seconds
        )

        return self._access_token

    def _is_token_valid(self) -> bool:
        """Check if the current token is still valid."""
        if not self._access_token or not self._expires_at:
            return False
        return datetime.now() < self._expires_at


# Usage
token_manager = TokenManager(
    client_id='my-backend-service',
    client_secret='super-secret-key',
    token_endpoint='https://auth.example.com/connect/token'
)

# Get token and use it
token = token_manager.get_access_token(['api.read', 'api.write'])
headers = {'Authorization': f'Bearer {token}'}</code></pre>
            </div>

            <h3>Node.js / TypeScript</h3>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">typescript</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-typescript">interface TokenResponse {
  access_token: string;
  token_type: string;
  expires_in: number;
  scope?: string;
}

class ClientCredentialsClient {
  private tokenEndpoint: string;
  private clientId: string;
  private clientSecret: string;
  private cachedToken?: string;
  private expiresAt?: Date;

  constructor(
    tokenEndpoint: string,
    clientId: string,
    clientSecret: string
  ) {
    this.tokenEndpoint = tokenEndpoint;
    this.clientId = clientId;
    this.clientSecret = clientSecret;
  }

  async getAccessToken(scopes?: string[]): Promise&lt;string&gt; {
    // Return cached token if still valid
    if (this.cachedToken && this.expiresAt && new Date() < this.expiresAt) {
      return this.cachedToken;
    }

    const params = new URLSearchParams({
      grant_type: 'client_credentials',
      client_id: this.clientId,
      client_secret: this.clientSecret,
    });

    if (scopes?.length) {
      params.set('scope', scopes.join(' '));
    }

    const response = await fetch(this.tokenEndpoint, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
      },
      body: params.toString(),
    });

    if (!response.ok) {
      throw new Error(`Token request failed: ${response.status}`);
    }

    const data: TokenResponse = await response.json();

    // Cache the token with a buffer before expiry
    this.cachedToken = data.access_token;
    this.expiresAt = new Date(
      Date.now() + (data.expires_in - 60) * 1000
    );

    return this.cachedToken;
  }
}

// Usage
const client = new ClientCredentialsClient(
  'https://auth.example.com/connect/token',
  'my-backend-service',
  'super-secret-key'
);

const token = await client.getAccessToken(['api.read', 'api.write']);</code></pre>
            </div>

            <h2 id="error-handling">Error Handling</h2>

            <p>Common error responses you may encounter:</p>

            <table>
                <thead>
                    <tr>
                        <th>Error</th>
                        <th>Description</th>
                        <th>Resolution</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>invalid_client</code></td>
                        <td>Client authentication failed</td>
                        <td>Verify client ID and secret are correct</td>
                    </tr>
                    <tr>
                        <td><code>invalid_scope</code></td>
                        <td>Requested scope is invalid or not allowed</td>
                        <td>Request only scopes the client is authorized for</td>
                    </tr>
                    <tr>
                        <td><code>unauthorized_client</code></td>
                        <td>Client is not authorized for this grant type</td>
                        <td>Ensure client is configured for client_credentials grant</td>
                    </tr>
                    <tr>
                        <td><code>server_error</code></td>
                        <td>Authorization server encountered an error</td>
                        <td>Retry the request; contact support if persistent</td>
                    </tr>
                </tbody>
            </table>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">json</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-json">// Example error response
{
  "error": "invalid_client",
  "error_description": "Client authentication failed"
}</code></pre>
            </div>

            <h2 id="best-practices">Best Practices</h2>

            <ul>
                <li><strong>Cache tokens</strong> - Store and reuse tokens until they expire to reduce token endpoint load</li>
                <li><strong>Add expiry buffer</strong> - Request new tokens slightly before expiration to avoid failed requests</li>
                <li><strong>Secure secrets</strong> - Use environment variables or secret management services</li>
                <li><strong>Request minimal scopes</strong> - Only request the scopes your service actually needs</li>
                <li><strong>Handle errors gracefully</strong> - Implement retry logic with exponential backoff</li>
                <li><strong>Rotate secrets</strong> - Periodically rotate client secrets as a security practice</li>
            </ul>

            <h2 id="use-cases">Common Use Cases</h2>

            <div class="docs-cards">
                <div class="docs-card">
                    <div class="docs-card-title">Microservice Communication</div>
                    <div class="docs-card-desc">Backend services authenticating with each other in a microservices architecture.</div>
                </div>
                <div class="docs-card">
                    <div class="docs-card-title">Scheduled Jobs</div>
                    <div class="docs-card-desc">Background tasks and cron jobs that need API access without user interaction.</div>
                </div>
                <div class="docs-card">
                    <div class="docs-card-title">CI/CD Pipelines</div>
                    <div class="docs-card-desc">Automated deployment scripts accessing protected APIs during builds.</div>
                </div>
            </div>

            <nav class="docs-page-nav">
                <a href="/docs/oauth/authorization-code.html" class="docs-page-nav-link prev">
                    <span class="docs-page-nav-label">Previous</span>
                    <span class="docs-page-nav-title">Authorization Code Flow</span>
                </a>
                <a href="/docs/oauth/access-tokens.html" class="docs-page-nav-link next">
                    <span class="docs-page-nav-label">Next</span>
                    <span class="docs-page-nav-title">Access Tokens</span>
                </a>
            </nav>
        </article>

        <aside class="docs-toc">
            <div class="docs-toc-title">On this page</div>
            <ul class="docs-toc-list"></ul>
        </aside>
    </main>

    <div class="docs-search-modal" id="search-modal">
        <div class="docs-search-modal-content">
            <input type="text" class="docs-search-modal-input" id="search-modal-input" placeholder="Search documentation...">
            <div class="docs-search-results" id="search-results"></div>
        </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-rust.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-docker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-http.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>
    <script src="/docs/js/docs.js"></script>
</body>
</html>
