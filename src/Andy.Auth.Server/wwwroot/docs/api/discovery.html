<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenID Connect Discovery - Andy Auth Documentation</title>
    <meta name="description" content="OpenID Connect discovery endpoints">
    <link rel="stylesheet" href="/docs/css/docs.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="/docs/images/favicon.png">
</head>
<body>
    <!-- Header -->
        <header class="docs-header">
        <div class="docs-header-inner">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <button class="docs-mobile-toggle" id="sidebar-toggle">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <a href="/docs/" class="docs-logo">
                    <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="32" height="32" rx="8" fill="currentColor"/>
                        <path d="M8 24V8h6l4 8 4-8h6v16h-5V14l-3.5 7h-3L13 14v10H8z" fill="white"/>
                    </svg>
                    <span class="docs-logo-text">
                        <span class="docs-logo-title">Andy Auth</span>
                        <span class="docs-logo-subtitle">Documentation</span>
                    </span>
                    <span class="docs-version">v1.0</span>
                </a>
            </div>

            <div class="docs-search">
                <div class="docs-search-wrapper">
                    <svg class="docs-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    <input type="text" class="docs-search-input" placeholder="Search documentation..." data-search-trigger readonly>
                    <span class="docs-search-shortcut">Ctrl K</span>
                </div>
            </div>

            <div class="docs-header-actions">
                <button class="docs-header-btn" id="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
                    </svg>
                </button>
                <a href="https://github.com/rivoli-ai/andy-auth" class="docs-header-btn" title="GitHub" target="_blank">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
                    </svg>
                </a>
                <a href="/" class="docs-header-link">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
                    </svg>
                    <span>Back to App</span>
                </a>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
        <aside class="docs-sidebar">
        <nav>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">Getting Started</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/" class="docs-sidebar-link">Overview</a></li>
                    <li><a href="/docs/quickstart.html" class="docs-sidebar-link">Quick Start</a></li>
                    <li><a href="/docs/installation.html" class="docs-sidebar-link">Installation</a></li>
                    <li><a href="/docs/configuration.html" class="docs-sidebar-link">Configuration</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">MCP Integration <span class="badge badge-new">Important</span></div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/mcp/overview.html" class="docs-sidebar-link">MCP Overview</a></li>
                    <li><a href="/docs/mcp/oauth-flow.html" class="docs-sidebar-link">OAuth 2.1 Flow</a></li>
                    <li><a href="/docs/mcp/claude-desktop.html" class="docs-sidebar-link">Claude Desktop</a></li>
                    <li><a href="/docs/mcp/chatgpt.html" class="docs-sidebar-link">ChatGPT</a></li>
                    <li><a href="/docs/mcp/vscode-extensions.html" class="docs-sidebar-link">VS Code Extensions</a></li>
                    <li><a href="/docs/mcp/dcr.html" class="docs-sidebar-link">Dynamic Client Registration</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">OAuth & OpenID Connect</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/oauth/concepts.html" class="docs-sidebar-link">Core Concepts</a></li>
                    <li><a href="/docs/oauth/authorization-code.html" class="docs-sidebar-link">Authorization Code Flow</a></li>
                    <li><a href="/docs/oauth/pkce.html" class="docs-sidebar-link">PKCE</a></li>
                    <li><a href="/docs/oauth/client-credentials.html" class="docs-sidebar-link">Client Credentials</a></li>
                    <li><a href="/docs/oauth/access-tokens.html" class="docs-sidebar-link">Access Tokens</a></li>
                    <li><a href="/docs/oauth/refresh-tokens.html" class="docs-sidebar-link">Refresh Tokens</a></li>
                    <li><a href="/docs/oauth/scopes.html" class="docs-sidebar-link">Scopes</a></li>
                    <li><a href="/docs/oauth/claims.html" class="docs-sidebar-link">Claims</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">Tutorials</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/tutorials/python.html" class="docs-sidebar-link">Python</a></li>
                    <li><a href="/docs/tutorials/csharp.html" class="docs-sidebar-link">C# / .NET</a></li>
                    <li><a href="/docs/tutorials/javascript.html" class="docs-sidebar-link">JavaScript</a></li>
                    <li><a href="/docs/tutorials/typescript.html" class="docs-sidebar-link">TypeScript</a></li>
                    <li><a href="/docs/tutorials/java.html" class="docs-sidebar-link">Java</a></li>
                    <li><a href="/docs/tutorials/go.html" class="docs-sidebar-link">Go</a></li>
                    <li><a href="/docs/tutorials/rust.html" class="docs-sidebar-link">Rust</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">API Reference</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/api/endpoints.html" class="docs-sidebar-link">Endpoints Overview</a></li>
                    <li><a href="/docs/api/authorize.html" class="docs-sidebar-link">Authorization</a></li>
                    <li><a href="/docs/api/token.html" class="docs-sidebar-link">Token</a></li>
                    <li><a href="/docs/api/userinfo.html" class="docs-sidebar-link">UserInfo</a></li>
                    <li><a href="/docs/api/introspect.html" class="docs-sidebar-link">Introspection</a></li>
                    <li><a href="/docs/api/revoke.html" class="docs-sidebar-link">Revocation</a></li>
                    <li><a href="/docs/api/register.html" class="docs-sidebar-link">Client Registration</a></li>
                    <li><a href="/docs/api/discovery.html" class="docs-sidebar-link active">Discovery</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">Admin Dashboard <span class="badge badge-new">New</span></div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/admin/dashboard.html" class="docs-sidebar-link">Dashboard</a></li>
                    <li><a href="/docs/admin/users.html" class="docs-sidebar-link">Users</a></li>
                    <li><a href="/docs/admin/clients.html" class="docs-sidebar-link">Clients</a></li>
                    <li><a href="/docs/admin/tokens.html" class="docs-sidebar-link">Tokens</a></li>
                    <li><a href="/docs/admin/audit-logs.html" class="docs-sidebar-link">Audit Logs</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">Deployment</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/deployment/railway.html" class="docs-sidebar-link">Railway</a></li>
                    <li><a href="/docs/deployment/docker.html" class="docs-sidebar-link">Docker</a></li>
                    <li><a href="/docs/deployment/production.html" class="docs-sidebar-link">Production</a></li>
                    <li><a href="/docs/deployment/azure.html" class="docs-sidebar-link">Azure</a></li>
                </ul>
            </div>
            <div class="docs-sidebar-section">
                <div class="docs-sidebar-title">Security</div>
                <ul class="docs-sidebar-nav">
                    <li><a href="/docs/security/overview.html" class="docs-sidebar-link">Security Overview</a></li>
                </ul>
            </div>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="docs-main">
        <article class="docs-content">
            <nav class="docs-breadcrumb">
                <a href="/docs/">Docs</a>
                <span class="docs-breadcrumb-sep">/</span>
                <a href="/docs/api/endpoints.html">API Reference</a>
                <span class="docs-breadcrumb-sep">/</span>
                <span class="docs-breadcrumb-current">Discovery</span>
            </nav>

            <h1>OpenID Connect Discovery</h1>
            <p class="lead">
                The discovery endpoints allow clients to automatically discover Andy Auth's capabilities,
                endpoints, and cryptographic keys. This is the starting point for any OAuth/OIDC integration.
            </p>

            <h2 id="openid-configuration">OpenID Configuration</h2>

            <div class="endpoint">
                <span class="endpoint-method get">GET</span>
                <span class="endpoint-path">/.well-known/openid-configuration</span>
            </div>

            <p>
                Returns a JSON document describing all OAuth 2.0 and OpenID Connect endpoints and capabilities
                supported by Andy Auth. This implements the OpenID Connect Discovery 1.0 specification.
            </p>

            <div class="callout callout-info">
                <div class="callout-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
                    First Step for MCP Clients
                </div>
                <p>
                    MCP clients should always start by fetching the discovery document to learn about
                    available endpoints, supported features, and how to authenticate. This allows clients
                    to work with any compliant authorization server.
                </p>
            </div>

            <h3 id="request-example">Request Example</h3>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">http</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-http">GET /.well-known/openid-configuration HTTP/1.1
Host: auth.example.com</code></pre>
            </div>

            <h3 id="response-example">Response Example</h3>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">json</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-json">{
  "issuer": "https://auth.example.com/",
  "authorization_endpoint": "https://auth.example.com/connect/authorize",
  "token_endpoint": "https://auth.example.com/connect/token",
  "userinfo_endpoint": "https://auth.example.com/connect/userinfo",
  "introspection_endpoint": "https://auth.example.com/connect/introspect",
  "revocation_endpoint": "https://auth.example.com/connect/revoke",
  "registration_endpoint": "https://auth.example.com/connect/register",
  "jwks_uri": "https://auth.example.com/.well-known/jwks",
  "scopes_supported": [
    "openid",
    "profile",
    "email",
    "offline_access"
  ],
  "response_types_supported": [
    "code"
  ],
  "response_modes_supported": [
    "query",
    "fragment",
    "form_post"
  ],
  "grant_types_supported": [
    "authorization_code",
    "refresh_token",
    "client_credentials"
  ],
  "subject_types_supported": [
    "public"
  ],
  "id_token_signing_alg_values_supported": [
    "RS256"
  ],
  "code_challenge_methods_supported": [
    "S256"
  ],
  "token_endpoint_auth_methods_supported": [
    "none",
    "client_secret_basic",
    "client_secret_post"
  ],
  "claims_supported": [
    "sub",
    "name",
    "given_name",
    "family_name",
    "preferred_username",
    "email",
    "email_verified",
    "picture",
    "updated_at"
  ]
}</code></pre>
            </div>

            <h3 id="discovery-fields">Discovery Fields</h3>

            <table>
                <thead>
                    <tr>
                        <th>Field</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>issuer</code></td>
                        <td>The issuer identifier URL (must match tokens' <code>iss</code> claim)</td>
                    </tr>
                    <tr>
                        <td><code>authorization_endpoint</code></td>
                        <td>URL for initiating authorization</td>
                    </tr>
                    <tr>
                        <td><code>token_endpoint</code></td>
                        <td>URL for exchanging codes/credentials for tokens</td>
                    </tr>
                    <tr>
                        <td><code>userinfo_endpoint</code></td>
                        <td>URL for fetching user claims</td>
                    </tr>
                    <tr>
                        <td><code>introspection_endpoint</code></td>
                        <td>URL for validating tokens (RFC 7662)</td>
                    </tr>
                    <tr>
                        <td><code>revocation_endpoint</code></td>
                        <td>URL for revoking tokens (RFC 7009)</td>
                    </tr>
                    <tr>
                        <td><code>registration_endpoint</code></td>
                        <td>URL for dynamic client registration (RFC 7591)</td>
                    </tr>
                    <tr>
                        <td><code>jwks_uri</code></td>
                        <td>URL for JSON Web Key Set (for token verification)</td>
                    </tr>
                    <tr>
                        <td><code>scopes_supported</code></td>
                        <td>List of supported OAuth scopes</td>
                    </tr>
                    <tr>
                        <td><code>response_types_supported</code></td>
                        <td>List of supported response types</td>
                    </tr>
                    <tr>
                        <td><code>grant_types_supported</code></td>
                        <td>List of supported grant types</td>
                    </tr>
                    <tr>
                        <td><code>code_challenge_methods_supported</code></td>
                        <td>Supported PKCE methods (S256)</td>
                    </tr>
                    <tr>
                        <td><code>token_endpoint_auth_methods_supported</code></td>
                        <td>Supported client authentication methods</td>
                    </tr>
                    <tr>
                        <td><code>claims_supported</code></td>
                        <td>List of claims available from UserInfo/ID token</td>
                    </tr>
                </tbody>
            </table>

            <h2 id="jwks">JSON Web Key Set (JWKS)</h2>

            <div class="endpoint">
                <span class="endpoint-method get">GET</span>
                <span class="endpoint-path">/.well-known/jwks</span>
            </div>

            <p>
                Returns the public keys used by Andy Auth to sign tokens. Clients and resource servers
                use these keys to verify JWT signatures.
            </p>

            <h3 id="jwks-request">Request Example</h3>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">http</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-http">GET /.well-known/jwks HTTP/1.1
Host: auth.example.com</code></pre>
            </div>

            <h3 id="jwks-response">Response Example</h3>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">json</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-json">{
  "keys": [
    {
      "kty": "RSA",
      "use": "sig",
      "kid": "key-2024-01",
      "alg": "RS256",
      "n": "sXchDaQebSXKcvLst...",
      "e": "AQAB"
    }
  ]
}</code></pre>
            </div>

            <h3 id="jwks-fields">JWK Fields</h3>

            <table>
                <thead>
                    <tr>
                        <th>Field</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>kty</code></td>
                        <td>Key type (e.g., "RSA")</td>
                    </tr>
                    <tr>
                        <td><code>use</code></td>
                        <td>Key usage: "sig" for signing, "enc" for encryption</td>
                    </tr>
                    <tr>
                        <td><code>kid</code></td>
                        <td>Key ID (matches the <code>kid</code> header in JWTs)</td>
                    </tr>
                    <tr>
                        <td><code>alg</code></td>
                        <td>Algorithm (e.g., "RS256")</td>
                    </tr>
                    <tr>
                        <td><code>n</code></td>
                        <td>RSA modulus (Base64URL encoded)</td>
                    </tr>
                    <tr>
                        <td><code>e</code></td>
                        <td>RSA exponent (Base64URL encoded)</td>
                    </tr>
                </tbody>
            </table>

            <h2 id="code-examples">Code Examples</h2>

            <h3>JavaScript - Discover and Initialize</h3>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">javascript</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-javascript">class OAuthClient {
  constructor(issuerUrl) {
    this.issuerUrl = issuerUrl;
    this.config = null;
  }

  async discover() {
    const response = await fetch(
      `${this.issuerUrl}/.well-known/openid-configuration`
    );

    if (!response.ok) {
      throw new Error('Failed to fetch discovery document');
    }

    this.config = await response.json();

    // Validate issuer matches
    if (this.config.issuer !== this.issuerUrl &&
        this.config.issuer !== `${this.issuerUrl}/`) {
      throw new Error('Issuer mismatch');
    }

    return this.config;
  }

  getAuthorizationUrl(params) {
    if (!this.config) {
      throw new Error('Call discover() first');
    }

    const url = new URL(this.config.authorization_endpoint);
    Object.entries(params).forEach(([key, value]) => {
      url.searchParams.set(key, value);
    });

    return url.toString();
  }

  async exchangeCode(code, codeVerifier, redirectUri) {
    if (!this.config) {
      throw new Error('Call discover() first');
    }

    const response = await fetch(this.config.token_endpoint, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      },
      body: new URLSearchParams({
        grant_type: 'authorization_code',
        code,
        redirect_uri: redirectUri,
        client_id: this.clientId,
        code_verifier: codeVerifier
      })
    });

    return response.json();
  }
}

// Usage
const client = new OAuthClient('https://auth.example.com');
await client.discover();

console.log('Authorization endpoint:', client.config.authorization_endpoint);
console.log('Supports PKCE:', client.config.code_challenge_methods_supported.includes('S256'));</code></pre>
            </div>

            <h3>Python</h3>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">python</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-python">import requests

class OAuthDiscovery:
    def __init__(self, issuer_url: str):
        self.issuer_url = issuer_url.rstrip('/')
        self.config = None

    def discover(self) -> dict:
        """Fetch and cache the discovery document."""
        response = requests.get(
            f'{self.issuer_url}/.well-known/openid-configuration'
        )
        response.raise_for_status()

        self.config = response.json()

        # Validate issuer
        expected_issuers = [self.issuer_url, f'{self.issuer_url}/']
        if self.config['issuer'] not in expected_issuers:
            raise ValueError(f"Issuer mismatch: {self.config['issuer']}")

        return self.config

    def get_jwks(self) -> dict:
        """Fetch the JSON Web Key Set."""
        if not self.config:
            self.discover()

        response = requests.get(self.config['jwks_uri'])
        response.raise_for_status()
        return response.json()

    @property
    def authorization_endpoint(self) -> str:
        return self.config['authorization_endpoint']

    @property
    def token_endpoint(self) -> str:
        return self.config['token_endpoint']

    @property
    def registration_endpoint(self) -> str | None:
        return self.config.get('registration_endpoint')

    def supports_dcr(self) -> bool:
        """Check if dynamic client registration is supported."""
        return 'registration_endpoint' in self.config

# Usage
discovery = OAuthDiscovery('https://auth.example.com')
config = discovery.discover()

print(f"Authorization endpoint: {discovery.authorization_endpoint}")
print(f"Supports DCR: {discovery.supports_dcr()}")

# Get public keys for JWT verification
jwks = discovery.get_jwks()
print(f"Number of signing keys: {len(jwks['keys'])}")</code></pre>
            </div>

            <h3>cURL</h3>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">bash</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-bash"># Fetch discovery document
curl https://auth.example.com/.well-known/openid-configuration | jq .

# Fetch JWKS
curl https://auth.example.com/.well-known/jwks | jq .

# Extract specific endpoint
curl -s https://auth.example.com/.well-known/openid-configuration | \
  jq -r '.authorization_endpoint'</code></pre>
            </div>

            <h2 id="jwt-verification">JWT Verification Using JWKS</h2>

            <p>
                To verify JWTs (access tokens, ID tokens), fetch the JWKS and use the appropriate key
                based on the token's <code>kid</code> (key ID) header.
            </p>

            <div class="code-block">
                <div class="code-block-header">
                    <span class="code-block-lang">javascript</span>
                    <button class="code-block-copy">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
                        Copy
                    </button>
                </div>
                <pre><code class="language-javascript">import jwt from 'jsonwebtoken';
import jwksClient from 'jwks-rsa';

// Create a JWKS client with caching
const client = jwksClient({
  jwksUri: 'https://auth.example.com/.well-known/jwks',
  cache: true,
  cacheMaxAge: 600000, // 10 minutes
  rateLimit: true
});

// Get the signing key
function getKey(header, callback) {
  client.getSigningKey(header.kid, (err, key) => {
    if (err) {
      callback(err);
      return;
    }
    const signingKey = key.getPublicKey();
    callback(null, signingKey);
  });
}

// Verify a token
function verifyToken(token) {
  return new Promise((resolve, reject) => {
    jwt.verify(token, getKey, {
      issuer: 'https://auth.example.com/',
      algorithms: ['RS256']
    }, (err, decoded) => {
      if (err) {
        reject(err);
      } else {
        resolve(decoded);
      }
    });
  });
}

// Usage
try {
  const claims = await verifyToken(accessToken);
  console.log('Token valid. Subject:', claims.sub);
} catch (err) {
  console.error('Token verification failed:', err.message);
}</code></pre>
            </div>

            <div class="callout callout-info">
                <div class="callout-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
                    Cache JWKS
                </div>
                <p>
                    Always cache the JWKS response to avoid making a request for every token verification.
                    Keys rarely change, so caching for 10-60 minutes is typically safe. Refresh the cache
                    if verification fails with an unknown <code>kid</code>.
                </p>
            </div>

            <nav class="docs-page-nav">
                <a href="/docs/api/register.html" class="docs-page-nav-link prev">
                    <span class="docs-page-nav-label">Previous</span>
                    <span class="docs-page-nav-title">Client Registration</span>
                </a>
                <a href="/docs/mcp/overview.html" class="docs-page-nav-link next">
                    <span class="docs-page-nav-label">Next</span>
                    <span class="docs-page-nav-title">MCP Overview</span>
                </a>
            </nav>
        </article>

        <aside class="docs-toc">
            <div class="docs-toc-title">On this page</div>
            <ul class="docs-toc-list"></ul>
        </aside>
    </main>

    <div class="docs-search-modal" id="search-modal">
        <div class="docs-search-modal-content">
            <input type="text" class="docs-search-modal-input" id="search-modal-input" placeholder="Search documentation...">
            <div class="docs-search-results" id="search-results"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-rust.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-docker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-http.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>
    <script src="/docs/js/docs.js"></script>
</body>
</html>
